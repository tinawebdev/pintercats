(()=>{"use strict";const e=document.querySelector("#images-container");let t=[];const a=e=>`\n    <div class="image-container">\n      <img src="${e}" alt="Cat Image" class="image">\n      <a class="${(e=>t[e]?"like-btn liked":"like-btn")(e)}"></a>\n    </div>\n  `,n=(n,s)=>{t=s.favorites,"results"===n?s.resultsArray.forEach((t=>{e.insertAdjacentHTML("beforeend",a(t.url))})):(t=>{Object.values(t).forEach((t=>{e.insertAdjacentHTML("beforeend",a(t))}))})(t)},s=()=>e.textContent="",r=document.querySelector(".nav-container"),i={headers:{"x-api-key":"041355a5-6f53-45d5-b984-900a93bf2514"}},o=document.getElementById("img-loader");function c(){o.classList.add("hide")}o.insertAdjacentHTML("beforeend",'\n  <img src="img/loader/cat.gif" alt="Loading">\n  <p>... loading more cats ...</p>\n');const l={resultsArray:[],favorites:localStorage.getItem("catsFavorites")?JSON.parse(localStorage.getItem("catsFavorites")):{},currentPage:"results",imagesLoaded:0,totalImages:0,readyToFetch:!1};async function d(){window.innerHeight+window.scrollY>=document.body.offsetHeight-1e3&&l.readyToFetch&&(l.readyToFetch=!1,u("results"))}async function u(e){!function(){const e=document.getElementById("favorites"),t=document.getElementById("results");e.addEventListener("click",g("favorites")),t.addEventListener("click",g("results"))}(),await async function(e){"results"===e?(o.classList.remove("hide"),l.resultsArray=await async function(){try{return await(await fetch("https://api.thecatapi.com/v1/images/search?limit=15",i)).json()}catch(e){}}(),l.imagesLoaded=0,l.totalImages=l.resultsArray.length,n(e,l)):(s(),n(e,l))}(e),function(){function e(){l.imagesLoaded++,l.imagesLoaded===l.totalImages&&(l.readyToFetch=!0,c())}document.querySelectorAll(".image").forEach((t=>t.addEventListener("load",e)))}(),document.querySelectorAll(".like-btn").forEach((e=>{e.getAttribute("listener")||(e.setAttribute("listener","true"),e.addEventListener("click",(e=>{const t=e.target,a=t.previousElementSibling.currentSrc;t.classList.toggle("liked"),l.favorites[a]?function(e){delete l.favorites[e],localStorage.setItem("catsFavorites",JSON.stringify(l.favorites)),"favorites"===l.currentPage&&u(l.currentPage)}(a):function(e){l.favorites[e]=e,localStorage.setItem("catsFavorites",JSON.stringify(l.favorites))}(a)})))}))}window.addEventListener("scroll",d);const g=e=>()=>{l.currentPage=e,c(),s(),"favorites"===l.currentPage?window.removeEventListener("scroll",d):window.addEventListener("scroll",d),(e=>{const t=t=>t===e?"is-active":"";r.innerHTML=`\n    <ul class="nav-items">\n      <li class="nav-link ${t("results")}" id="results">All cats</li>\n      <li class="nav-link ${t("favorites")}" id="favorites">Favorite cats</li>\n    </ul>\n  `})(l.currentPage),u(l.currentPage)};u(l.currentPage)})();