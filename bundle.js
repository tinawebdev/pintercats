(()=>{"use strict";const e=document.querySelector("#images-container");let t=[];const a=e=>`\n    <div class="image-container">\n      <img src="${e}" alt="Cat Image" class="image">\n      <a class="${(e=>t[e]?"like-btn liked":"like-btn")(e)}"></a>\n    </div>\n  `,n=()=>e.textContent="",r=document.querySelector(".nav-container"),s={headers:{"x-api-key":"041355a5-6f53-45d5-b984-900a93bf2514"}},i=document.getElementById("img-loader");function o(){i.classList.add("hide")}i.insertAdjacentHTML("beforeend",'\n  <img src="img/loader/cat.gif" alt="Loading">\n  <p>... loading more cats ...</p>\n');const c={resultsArray:[],favorites:localStorage.getItem("catsFavorites")?JSON.parse(localStorage.getItem("catsFavorites")):{},currentPage:"results",imagesLoaded:0,totalImages:0,readyToFetch:!1};async function l(){window.innerHeight+window.scrollY>=document.body.offsetHeight-1e3&&c.readyToFetch&&(c.readyToFetch=!1,d("results"))}async function d(r){!function(){const e=document.getElementById("favorites"),t=document.getElementById("results");e.addEventListener("click",u("favorites")),t.addEventListener("click",u("results"))}(),await async function(r){"results"===r&&(i.classList.remove("hide"),c.resultsArray=await async function(){try{return await(await fetch("https://api.thecatapi.com/v1/images/search?limit=15",s)).json()}catch(e){}}(),c.imagesLoaded=0,c.totalImages=c.resultsArray.length),(({favorites:r,currentPage:s,resultsArray:i})=>{t=r,"favorites"===s?(n(),Object.values(t).forEach((t=>{e.insertAdjacentHTML("beforeend",a(t))}))):i.forEach((t=>{e.insertAdjacentHTML("beforeend",a(t.url))}))})(c)}(r),function(){function e(){c.imagesLoaded++,c.imagesLoaded===c.totalImages&&(c.readyToFetch=!0,o())}document.querySelectorAll(".image").forEach((t=>t.addEventListener("load",e)))}(),document.querySelectorAll(".like-btn").forEach((e=>{e.getAttribute("listener")||(e.setAttribute("listener","true"),e.addEventListener("click",(e=>{const t=e.target,a=t.previousElementSibling.currentSrc;t.classList.toggle("liked"),c.favorites[a]?function(e){delete c.favorites[e],localStorage.setItem("catsFavorites",JSON.stringify(c.favorites)),"favorites"===c.currentPage&&d(c.currentPage)}(a):function(e){e&&(c.favorites[e]=e,localStorage.setItem("catsFavorites",JSON.stringify(c.favorites)))}(a)})))}))}window.addEventListener("scroll",l);const u=e=>()=>{c.currentPage=e,"favorites"===c.currentPage?window.removeEventListener("scroll",l):window.addEventListener("scroll",l),o(),n(),(e=>{const t=t=>t===e?"is-active":"";r.innerHTML=`\n    <ul class="nav-items">\n      <li class="nav-link ${t("results")}" id="results">All cats</li>\n      <li class="nav-link ${t("favorites")}" id="favorites">Favorite cats</li>\n    </ul>\n  `})(c.currentPage),d(c.currentPage)};d(c.currentPage)})();